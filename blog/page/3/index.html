<!DOCTYPE html> <html> <head> <title>Alpine Lab, blog technique</title> <meta charset=UTF-8> <meta content='On parle de développement web, d&#39;entreprenariat, de Ruby, de Rails, de Haml, de CSS/Sass, de CoffeeScript et d&#39;Ember.js, ...' name=description> <meta content='width=device-width, initial-scale=1.0, user-scalable=no' name=viewport> <meta content='Alpine Lab, blog technique' property='og:title'> <meta content='On parle de développement web, d&#39;entreprenariat, de Ruby, de Rails, de Haml, de CSS/Sass, de CoffeeScript et d&#39;Ember.js, ...' property='og:description'> <meta content=fr_FR property='og:locale'> <meta content='Alpine Lab' property='og:site_name'> <meta content='https://www.alpine-lab.com/blog/page/3/' property='og:url'> <meta content='https://www.alpine-lab.com/images/logo-alpinelab-500-cebd1677.png' property='og:image'> <meta content=website property='og:type'> <link href='/apple-touch-icon-180x180-precomposed.png' rel=apple-touch-icon sizes=180x180> <link href='/apple-touch-icon-152x152-precomposed.png' rel=apple-touch-icon sizes=152x152> <link href='/apple-touch-icon-144x144-precomposed.png' rel=apple-touch-icon sizes=144x144> <link href='/apple-touch-icon-114x114-precomposed.png' rel=apple-touch-icon sizes=114x114> <link href='/apple-touch-icon-72x72-precomposed.png' rel=apple-touch-icon sizes=72x72> <link href='/apple-touch-icon-precomposed.png' rel=apple-touch-icon> <link href='/favicon.png' rel='shortcut icon'> <link href='/favicon.ico' rel=icon type='image/ico'> <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700%7CMontserrat:400,700' rel=stylesheet> <link href="/stylesheets/blog-4694b20b.css" rel=stylesheet /> <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.min.css" rel=stylesheet /> </head> <body class='blog blog_page blog_page_3 blog_page_3_index'> <meta content='Alpine Lab, blog technique' itemprop=name> <meta content='On parle de développement web, d&#39;entreprenariat, de Ruby/Rails, de Haml/Slim, de Sass, de CoffeeScript et d&#39;Ember.js' itemprop=description> <meta content='https://www.alpine-lab.com/blog' itemprop=url> <meta content=fr itemprop=inLanguage> <meta content='https://www.alpine-lab.com/images/logo-alpinelab-500-cebd1677.png' itemprop=image> <div id=wrapper> <header> <a href="/blog"><div class=logo></div> <h1 class=sitename><span class=alpine>Alpine</span><span class=lab>Lab</span> <span class=blog>blog technique</span> </h1> </a><div class=social-networks> <a href="https://github.com/alpinelab" target=_blank><i class='fa fa-github'></i> </a><a href="https://twitter.com/alpinelab" target=_blank><i class='fa fa-twitter'></i> </a></div> </header> <div id=main> <section class=posts-listing> <article itemscope itemtype='http://schema.org/BlogPosting'> <meta content='&lt;p&gt;Depuis toujours, je génère mes vues &lt;a href=&quot;http://devise.plataformatec.com.br&quot;&gt;Devise&lt;/a&gt; en ERB, comme un bon élève, en suivant la &lt;a href=&quot;http://devise.plataformatec.com.br/#getting-started/configuring-views&quot;&gt;documentation&lt;/a&gt; :&lt;/p&gt; &lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight shell&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rails generate devise:views &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt; &lt;p&gt;Mais ça, c&#39;était avant. Je viens de découvrir que &lt;a href=&quot;https://github.com/norman&quot;&gt;Norman Clarke&lt;/a&gt;, le créateur et mainteneur de &lt;a href=&quot;http://haml.info&quot;&gt;Haml&lt;/a&gt;, avait sorti un un...&lt;/p&gt;' itemprop=description> <meta content='https://www.alpine-lab.com//blog/generer-ses-vues-devise-en-haml/' itemprop=url> <meta content=fr itemprop=inLanguage> <h2 itemprop='name headline'><a href="/blog/generer-ses-vues-devise-en-haml/">Générer ses vues Devise en Haml</a></h2> <div class=post-body itemprop=articleBody><p>Depuis toujours, je génère mes vues <a href="http://devise.plataformatec.com.br">Devise</a> en ERB, comme un bon élève, en suivant la <a href="http://devise.plataformatec.com.br/#getting-started/configuring-views">documentation</a> :</p> <div class=highlight><pre class="highlight shell"><code><span class="nv">$ </span>rails generate devise:views&#x000A;</code></pre></div> <p>Mais ça, c&#39;était avant. Je viens de découvrir que <a href="https://github.com/norman">Norman Clarke</a>, le créateur et mainteneur de <a href="http://haml.info">Haml</a>, avait sorti un un petit outil en lignes de commandes qui permet de convertir du ERB en Haml : il s&#39;appelle intelligemment <a href="https://rubygems.org/gems/html2haml">html2haml</a>.</p> <p>On l&#39;installe comme ça :</p> <div class=highlight><pre class="highlight shell"><code><span class="nv">$ </span>gem <span class="nb">install </span>html2haml&#x000A;</code></pre></div> <p>Ensuite, on convertit toutes ses vues Devise d&#39;un seul coup comme ça :</p> <div class=highlight><pre class="highlight shell"><code><span class="nv">$ </span><span class="k">for </span>file <span class="k">in </span>app/views/devise/<span class="k">**</span>/<span class="k">*</span>.erb<span class="p">;</span> <span class="k">do </span>html2haml <span class="nt">-e</span> <span class="nv">$file</span> <span class="k">${</span><span class="nv">file</span><span class="p">%erb</span><span class="k">}</span>haml <span class="o">&amp;&amp;</span> <span class="nb">rm</span> <span class="nv">$file</span><span class="p">;</span> <span class="k">done</span>&#x000A;</code></pre></div> <p>Tout simplement.</p> <h4 id=sources>Sources</h4> <p>C&#39;est même plus une &ldquo;source&rdquo;, c&#39;est carrément du pompage traduit, mais je me suis inspiré de cet <a href="https://github.com/plataformatec/devise/wiki/How-To:-Create-Haml-and-Slim-Views">article du wiki Devise</a>, qui explique d&#39;ailleurs aussi comment traduire ses vues en <a href="http://slim-lang.com">Slim</a>, si vous préférez.</p> </div> </article> <article itemscope itemtype='http://schema.org/BlogPosting'> <meta content='&lt;p&gt;Sur un site &lt;a href=&quot;http://rubyonrails.org&quot;&gt;Rails&lt;/a&gt; dont le contrôle d&amp;#39;accès est géré par &lt;a href=&quot;http://devise.plataformatec.com.br&quot;&gt;Devise&lt;/a&gt;, on a parfois besoin d&amp;#39;interdire l&amp;#39;enregistrement de nouveaux utilisateurs (si les utilisateurs sont les administrateurs, dans le cadre d&amp;#39;un &lt;em&gt;back office&lt;/em&gt;, par exemple).' itemprop=description> <meta content='https://www.alpine-lab.com//blog/interdire-uniquement-l-enregistrement-de-nouveaux-utilisateurs-sous-devise/' itemprop=url> <meta content=fr itemprop=inLanguage> <h2 itemprop='name headline'><a href="/blog/interdire-uniquement-l-enregistrement-de-nouveaux-utilisateurs-sous-devise/">Interdire uniquement l'enregistrement de nouveaux utilisateurs sous Devise</a></h2> <div class=post-body itemprop=articleBody><p>Sur un site <a href="http://rubyonrails.org">Rails</a> dont le contrôle d&#39;accès est géré par <a href="http://devise.plataformatec.com.br">Devise</a>, on a parfois besoin d&#39;interdire l&#39;enregistrement de nouveaux utilisateurs (si les utilisateurs sont les administrateurs, dans le cadre d&#39;un <em>back office</em>, par exemple).</p> <p>À première vue, on pourrait se dire qu&#39;il suffit de supprimer le rôle <code>:registerable</code> dans le modèle, mais cette solution a un inconvénient majeur : elle supprime purement et simplement l&#39;accès au contrôleur <code>RegistrationsController</code>, l&#39;utilisateur ne peut donc plus modifier les information de son compte (son nom, son adresse email, son mot de passe, etc&hellip;).</p> <p>Il y a donc une autre solution, très simple, et qui permet de garder le rôle <code>:registerable</code> : on va supprimer toutes les routes menant au contrôleur, puis recréer seulement celles donc on a besoin.</p> <p>Par défaut, on a un <code>config/routes.rb</code> qui ressemble à ça :</p> <div class=highlight><pre class="highlight ruby"><code><span class="n">devise_for</span> <span class="ss">:users</span>&#x000A;</code></pre></div> <p>Il faut donc le modifier pour qu&#39;il ressemble à ça :</p> <div class=highlight><pre class="highlight ruby"><code><span class="n">devise_for</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:skip</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="ss">:registrations</span><span class="p">]</span>&#x000A;<span class="n">as</span> <span class="ss">:user</span> <span class="k">do</span>&#x000A;  <span class="n">get</span> <span class="s1">'users/edit'</span> <span class="o">=&gt;</span> <span class="s1">'devise/registrations#edit'</span><span class="p">,</span> <span class="ss">:as</span> <span class="o">=&gt;</span> <span class="s1">'edit_user_registration'</span>&#x000A;  <span class="n">put</span> <span class="s1">'users'</span> <span class="o">=&gt;</span> <span class="s1">'devise/registrations#update'</span><span class="p">,</span> <span class="ss">:as</span> <span class="o">=&gt;</span> <span class="s1">'user_registration'</span>&#x000A;<span class="k">end</span>&#x000A;</code></pre></div> <p>On voit que l&#39;on supprime donc toutes les routes vers le contrôleur <code>RegistrationsController</code> (avec l&#39;option <code>:skip =&gt; [:registrations]</code>) puis que l&#39;on recrée les routes <code>edit</code> (qui affiche le formulaire de modification du compte utilisateur) et <code>update</code> (qui effectue véritablement les modifications en base de données).</p> <p>La seule erreur que cette modification va engendrer, c&#39;est que le <em>helper</em> <code>new_registration_path</code> n&#39;existe plus (puisque la route vers <code>devise/registrations#new</code> n&#39;existe plus). Il faut donc aller modifier la vue partielle <code>app/views/devise/shared/_links.html.erb</code> et <strong>supprimer la partie suivante</strong> (qui génère normalement un lien &lsquo;Sign up&rsquo;) :</p> <div class=highlight><pre class="highlight erb"><code><span class="cp">&lt;%-</span> <span class="k">if</span> <span class="n">devise_mapping</span><span class="p">.</span><span class="nf">registerable?</span> <span class="o">&amp;&amp;</span> <span class="n">controller_name</span> <span class="o">!=</span> <span class="s1">'registrations'</span> <span class="cp">%&gt;</span>&#x000A;  <span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Sign up"</span><span class="p">,</span> <span class="n">new_registration_path</span><span class="p">(</span><span class="n">resource_name</span><span class="p">)</span> <span class="cp">%&gt;</span>&#x000A;<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">-%&gt;</span>&#x000A;</code></pre></div> <h3 id=bonus-m-nage>Bonus : ménage</h3> <p>Si vous aviez généré les vues Devise dans votre propre application pour les personnaliser (voir le post <a href="/posts/generer-ses-vues-devise-en-haml">Générer ses vues Devise en Haml</a>), vous pouvez en supprimer une qui ne vous servira jamais (celle avec le formulaire d&#39;inscription d&#39;un nouvel utilisateur) :</p> <div class=highlight><pre class="highlight shell"><code><span class="nv">$ </span><span class="nb">rm</span> <span class="nt">-f</span> app/views/devise/registrations/new.html.erb&#x000A;</code></pre></div> <p>Perso, je ne me sers pas non plus des vues des contrôleurs <code>ConfirmationsController</code> et <code>UnlocksController</code>, donc généralement, je les vire aussi (mais après, c&#39;est à vous de voir&hellip;) :</p> <div class=highlight><pre class="highlight shell"><code><span class="nv">$ </span><span class="nb">rm</span> <span class="nt">-rf</span> app/views/devise/confirmations/&#x000A;<span class="nv">$ </span><span class="nb">rm</span> <span class="nt">-rf</span> app/views/devise/unlocks/&#x000A;</code></pre></div> <h4 id=sources>Sources</h4> <ul> <li>cette <a href="http://stackoverflow.com/questions/6734323/how-do-i-remove-the-devise-route-to-sign-up">question sur StackOverflow</a></li> <li>cet <a href="http://blog.robotex.de/read/devise-disabling-sign-up">article de Robotex</a></li> <li>et bien sûr, la <a href="http://devise.plataformatec.com.br">doc</a> et le <a href="https://github.com/plataformatec/devise/wiki">wiki</a> de Devise</li> </ul> </div> </article> <article itemscope itemtype='http://schema.org/BlogPosting'> <meta content='&lt;p&gt;&lt;em&gt;&lt;strong&gt;UPDATE&lt;/strong&gt; Article mis à jour le 30/10/2013 pour intégrer la nouvelle convention de nommage de Font Awesome 4&lt;/em&gt;&lt;/p&gt; &lt;p&gt;Aujourd&#39;hui, j&#39;ai décidé d&#39;intégrer les &lt;em&gt;font icons&lt;/em&gt; &lt;a href=&quot;http://fortawesome.github.com/Font-Awesome/&quot;&gt;Font-Awesome&lt;/a&gt; sur notre blog (qui est généré par &lt;a href=&quot;http://middlemanapp.com/&quot;&gt;Middleman&lt;/a&gt; comme expliqué dans &lt;a href=&quot;#&quot;&gt;un precédent...&lt;/a&gt;&lt;/p&gt;' itemprop=description> <meta content='https://www.alpine-lab.com//blog/installer-font-awesome-sous-middleman/' itemprop=url> <meta content=fr itemprop=inLanguage> <h2 itemprop='name headline'><a href="/blog/installer-font-awesome-sous-middleman/">Installer Font Awesome sous Middleman</a></h2> <div class=post-body itemprop=articleBody><p><em><strong>UPDATE</strong> Article mis à jour le 30/10/2013 pour intégrer la nouvelle convention de nommage de Font Awesome 4</em></p> <p>Aujourd&#39;hui, j&#39;ai décidé d&#39;intégrer les <em>font icons</em> <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome</a> sur notre blog (qui est généré par <a href="http://middlemanapp.com/">Middleman</a> comme expliqué dans <a href="#">un precédent article</a>).</p> <h3 id=historique>Historique</h3> <p>Pour ceux qui ne savent pas ce que sont les <em>font icons</em>, voilà un petit rappel.</p> <p>Dans la vie, il y a ce que j&#39;appelle les <em>font nerds</em>. Ce sont généralement des designers qui sont passionnés par un truc que, personnellement, je ne comprends pas du tout : les polices d&#39;écriture (ou &ldquo;fonts&rdquo;). Je les aime beaucoup, hein, c&#39;est pas la question, Martin, notre designer préféré en est un. C&#39;est juste que je ne les comprend pas :-)</p> <p>Bref, un de ces joyeux lurons s&#39;est dit un jour : au lieu de faire un &lsquo;A&rsquo;, puis un &lsquo;B&rsquo;, etc&hellip; si je faisais plutôt une maison, une flêche, un téléphone, etc&hellip; Ça a donné Wingdings. C&#39;était un peu moche.</p> <p><img title=Wingdings alt=Wingdings width=391 height=204 src="/images/blog/font-awesome-wingdings-3071045e.gif"/></p> <p>Plus tard, d&#39;autres mecs - le W3C - ont travaillé pendant des années pour nous pondre notamment le langage CSS et ses possibilités de travailler les polices facilement (changer les couleurs, tailles, ombres, orientations, etc&hellip;).</p> <p>En poussant le raisonnement, et devant la généralisation de l&#39;utilisation de CSS (et notamment de la fameuse directive <code>@font-face</code> qui permet d&#39;utiliser n&#39;importe quelle police dans un navigateur, même si celle-ci n&#39;est pas installée dans le système), un font-nerd s&#39;est dit : &ldquo;Hey, si je fais des icônes canons comme si c&#39;était des caractères, chacun pourra les adapter à sa charte graphique !&rdquo;. Pof ! Les <em>font icons</em> (ou <em>icon fonts</em>, selon&hellip;) étaient nées.</p> <p>Voilà pour l&#39;historique. Il existe maintenant pas mal de packs de <em>font icons</em> téléchargeables et utilisables librement sur le net (voir en bas de l&#39;article pour quelques pointeurs).</p> <h3 id=int-gration-middleman>Intégration à Middleman</h3> <p>Avant, il y avait une feinte, pour adapter Font Awesome à Middleman, mais maintenant il y a <a href="http://www.bootstrapcdn.com">Bootstrap CDN</a> qui nous sert directement le CSS nécessaire. Il suffit donc d&#39;ajouter à ses pages une balise stylesheet :</p> <div class=highlight><pre class="highlight html"><code><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.min.css"</span> <span class="na">media=</span><span class="s">"screen"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>&#x000A;</code></pre></div> <p>Ou, en Sass :</p> <div class=highlight><pre class="highlight sass"><code><span class="o">=</span> <span class="nt">stylesheet_link_tag</span> <span class="s1">'//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.min.css'</span>&#x000A;</code></pre></div> <p>C&#39;est tout (je vous laisse ajuster avec le numéro de version adéquate au moment où vous lirez cet article).</p> <h3 id=utilisation-des-font-icons>Utilisation des font-icons</h3> <p>OK, c&#39;est bien beau, on a ajoutée une police bizarre à notre header HTML, maintenant quoi ?</p> <p>Il suffit d&#39;ajouter à une page la balise HTML <code>&lt;i class=&quot;fa fa-github&quot;&gt;&lt;/i&gt;</code> pour faire apparaitre une petite icone GitHub. En Slim, ça donne ça :</p> <div class=highlight><pre class="highlight slim"><code><span class="nt">i</span><span class="nc">.fa.fa-github</span>&#x000A;</code></pre></div> <p>Ça, c&#39;est quelques exemples :</p> <p><img title="Exemple d'icones Font Awesome" alt="Exemple d'icones Font Awesome" width=406 height=48 src="/images/blog/font-awesome-examples-5ea26303.png"/></p> <p>Et comme c&#39;est une balise HTML contenant du texte (dont les caractères sont des dessins, certe, mais du texte quand même), on peut lui appliquer les styles qu&#39;on veut. Par exemple, on voudrait qu&#39;elle soit rouge et qu&#39;elle devienne bleue quand la souris de l&#39;utilisateur est au-dessus ? Rien de plus simple ?</p> <div class=highlight><pre class="highlight sass"><code><span class="nt">i</span><span class="nc">.fa.fa-github</span>&#x000A;  <span class="nl">color</span><span class="p">:</span> <span class="no">red</span>&#x000A;  <span class="k">&amp;</span><span class="nd">:hover</span>&#x000A;    <span class="nl">color</span><span class="p">:</span> <span class="no">blue</span>&#x000A;</code></pre></div> <p>Easy, non ? Et on peut aussi ajouter d&#39;autres classes à la balise :</p> <ul> <li><code>fa-lg</code>, <code>fa-2x</code>, <code>fa-3x</code> ou <code>fa-4x</code> indiquent la taille de l&#39;icône</li> <li><code>fa-spin</code> la fait tourner sur elle-même</li> <li><code>fa-rotate-*</code> et <code>fa-flip-*</code> l&#39;inclinent ou la retournent</li> <li>&hellip; et bien d&#39;autres encore que vous pouvez retrouver dans la <a href="http://fortawesome.github.io/Font-Awesome/examples">documentation de Font Awesome</a></li> </ul> <p>Et voilà, vous savez tout ! Essayez, jouez avec, c&#39;est super facile.</p> <h3 id=autres-packs-dicons-chouettes-et-libres-sous-licence-cc-ou-sil>Autres packs d&#39;icons chouettes et libres (sous licence CC ou SIL)</h3> <ul> <li><a href="http://fortawesome.github.com/Font-Awesome">Font-Awesome</a> : celui que j&#39;utilise dans ce tutorial (et sur ce blog), il a été conçu pour être utilisé avec <a href="http://twitter.github.com/bootstrap">Bootstrap</a></li> <li><a href="http://www.zurb.com/playground/foundation-icons">Foundation Icon Fonts 2</a> : le pack d&#39;icônes du projet <a href="http://foundation.zurb.com">Foundation</a></li> <li><a href="http://modernpictograms.com">Modern Pictograms</a> : un des premiers gros projets de <em>font icons</em></li> <li><a href="http://icons.marekventur.de">Raphaël Icon Set</a> : un pack d&#39;icon fait à l&#39;origine pour être utilisé avec <a href="http://raphaeljs.com">Raphaël</a>, mais qui fonctinone très bien tout seul</li> <li><a href="http://icomoon.io/#preview-free">IcoMoon</a> : ce pack a une version gratuite pas mal du tout et 2 versions payantes au-dessus</li> <li>Et pour vous faire un pack de <em>font icons</em> custom, vous pouvez utiliser <a href="http://fontello.com">Fontello</a> ou <a href="http://icomoon.io/app">IcoMoon App</a> qui permet de choisir parmis plein de gros packs les icônes qu&#39;on veut, et d&#39;en faire une police (on peut même choisir à quel caractère on assigne chaque icône)</li> </ul> <h4 id=liens>Liens</h4> <ul> <li>Le <a href="https://github.com/blog/1135-the-making-of-octicons">&ldquo;making of&rdquo; de Octicons</a>, les <em>font icons</em> de GitHub, intéressant pour comprendre comment on fait ces trucs</li> </ul> </div> </article> <div class=pagination-wrapper> <a href="/blog/page/2/" class=previous-page>&larr; Articles plus récents</a> <a href="/blog/page/4/" class=next-page>Articles plus anciens &rarr;</a> <div class=pagination> Page 3 sur 6 </div> </div> </section> </div> </div> <div id=corporate-btn> <a href="/">Alpine Lab <span class=caret></span> </a></div> <footer> <p> Le blog d'<a href="https://plus.google.com/+AlpineLab" rel=publisher>Alpine Lab</a> est publié sous license <a href="https://creativecommons.org/licenses/by/3.0/fr/">Creative Commons Attribution 3.0 (cc-by-3.0)</a>. Le code est sous licence <a href="https://opensource.org/licenses/MIT">MIT</a>. </p> </footer> </body> </html>